clear all;
close all;
clc;

load data_Nvalues

load data_NShapedSystem

x_vals = linspace(0, 100.5, 1000);

figure('Position', [100, 100, 600, 600]);

set(gcf, 'Color', 'w');
hold on;
N_values = x1(2,:); u_values = x1(1,:);

Np = N_values(1334); up = u_values(1334);
Nm = N_values(1608); um = u_values(1608);

N_values1 = N_values(1:1334); u_values1 = u_values(1:1334);
N_values2 = N_values(1334:1608); u_values2 = u_values(1334:1608);
N_values3 = N_values(1608:end); u_values3 = u_values(1608:end);



% xline(Nm,  'Color',[0.800000011920929 0.800000011920929 0.800000011920929], 'LineWidth', 3);
% xline(Np,  'Color',[0.800000011920929 0.800000011920929 0.800000011920929], 'LineWidth', 3);

area = fill([[Nm,Nm] fliplr([Np,Np])],[[0,7] fliplr([0,7])],[0.933333337306976 0.933333337306976 0.933333337306976],'edgealpha', '0', 'facealpha', '.5');


plot([Nm,Nm],[0,7], 'Color',[0.800000011920929 0.800000011920929 0.800000011920929], 'LineWidth', 3);
plot([Np,Np],[0,7], 'Color',[0.800000011920929 0.800000011920929 0.800000011920929], 'LineWidth', 3);

% xline(N1, 'LineWidth', 2, 'Color','b');
% xline(N2, 'LineWidth', 2, 'Color','b');
% xline(N3, 'LineWidth', 2, 'Color','b');

plot([N1,N1],[0,7], 'LineWidth', 2, 'Color','b');
plot([N2,N2],[0,7], 'LineWidth', 2, 'Color','b');
plot([N3,N3],[0,7], 'LineWidth', 2, 'Color','b');

plot(N_values1,u_values1, 'k-', 'LineWidth', 3); 
plot(N_values2,u_values2, 'k--', 'LineWidth', 3); 
plot(N_values3,u_values3, 'k-', 'LineWidth', 3); 

plot([0,N2], [y_f_l2_points(1),y_f_l2_points(1)],'LineWidth',1.5,'LineStyle',':','Color','k');
plot([0,N2], [y_f_l2_points(2),y_f_l2_points(2)],'LineWidth',1.5,'LineStyle',':','Color','k');
plot([0,N2], [y_f_l2_points(3),y_f_l2_points(3)],'LineWidth',1.5,'LineStyle',':','Color','k');


plot([Nm, Np], [um, up], 'ro', 'MarkerSize', 8, 'MarkerFaceColor', 'r'); 


plot(N1, y_f_l1_points, 'ko', 'MarkerSize', 8, 'MarkerFaceColor', 'k'); 
plot(N3, y_f_l3_points, 'ko', 'MarkerSize', 8, 'MarkerFaceColor', 'k'); 
plot(N2, y_f_l2_points(1), 'ko', 'MarkerSize', 8, 'MarkerFaceColor', 'k'); 
plot(N2, y_f_l2_points(2), 'ko', 'MarkerSize', 8, 'LineWidth', 2, 'MarkerFaceColor', 'w'); 
plot(N2, y_f_l2_points(3), 'ko', 'MarkerSize', 8, 'MarkerFaceColor', 'k'); 


axis equal
xlim([0, 10]);
ylim([0, 7]);

set(gca, 'XTick', [], 'XTickLabel', []);
set(gca, 'YTick', [], 'YTickLabel', []);
set(gca, 'LineWidth', 2);

%%
annotation('arrow',[0.1303 0.1303],...
    [0.778333333333337 0.858333333333337],'LineWidth',2,'HeadWidth',15,...
    'HeadLength',15);
annotation('arrow',[0.9 0.97],[0.246166666666667 0.246166666666667],...
    'LineWidth',2,...
    'HeadWidth',15,...
    'HeadLength',15);

annotation('textbox',...
    [0.0335576923076947 0.799166666666672 0.0795192307692285 0.105833333333334],...
    'String',{'$u$'},...
    'Interpreter','latex',...
    'FontSize',48,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.872656250000003 0.150833333333333 0.079843749999997 0.0933333333333357],...
    'String',{'$N$'},...
    'Interpreter','latex',...
    'FontSize',39,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation('textbox',...
    [0.716320512820539 0.469166666666674 0.301179487179471 0.0500034847218184],...
    'String','$f(u,N-u)=0$',...
    'Rotation',40,...
    'Interpreter','latex',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');


annotation(gcf,'textbox',...
    [0.02 0.580000000000003 0.0843405448717987 0.0884654800431556],...
    'String','$u_{-}$',...
    'Interpreter','latex',...
    'FontSize',35,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation(gcf,'textbox',...
    [0.02 0.50 0.0843405448717987 0.0884654800431556],...
    'String','$u_{0}$',...
    'Interpreter','latex',...
    'FontSize',35,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation(gcf,'textbox',...
    [0.02 0.40 0.0843405448717987 0.0884654800431556],...
    'String','$u_{+}$',...
    'Interpreter','latex',...
    'FontSize',35,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.385000000000003 0.175000000000001 0.0799999999999985 0.0701321467098225],...
    'Color',[0 0 1],...
    'String','$N_{1}$',...
    'Interpreter','latex',...
    'FontSize',24,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.53 0.175000000000001 0.0799999999999985 0.0701321467098225],...
    'Color',[0 0 1],...
    'String','$N_{2}$',...
    'Interpreter','latex',...
    'FontSize',24,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.639 0.175000000000001 0.0799999999999985 0.0701321467098225],...
    'Color',[0 0 1],...
    'String','$N_{3}$',...
    'Interpreter','latex',...
    'FontSize',24,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.512500000000001 0.632500000000001 0.0383333333333336 0.0542988133764982],...
    'String','$u=N_{-}$',...
    'Rotation',90,...
    'Interpreter','latex',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation('textbox',...
    [0.651666666666669 0.632500000000001 0.0383333333333336 0.0542988133764982],...
    'String','$u=N_{+}$',...
    'Rotation',90,...
    'Interpreter','latex',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');

%%

annotation('textbox',...
    [0.599000000000002 0.588333333333333 0.0976666666666649 0.0441666666666668],...
    'Color',[1 0 0],...
    'String','SNB',...
    'Interpreter','latex',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation('textbox',...
    [0.417500000000001 0.379166666666667 0.0941666666666656 0.0476321467098262],...
    'Color',[1 0 0],...
    'String','SNB',...
    'Interpreter','latex',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');


figure_name = ['./Figure1b.eps'];
saveas(gcf, figure_name, 'epsc');

